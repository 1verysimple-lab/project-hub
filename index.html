<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blues' Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&display=swap');

        :root {
            --bg-color: #0f1115; /* Deep space grey */
            --card-bg: #181b21;
            --accent: #6366f1; /* Indigo 500 */
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
        }

        /* Bento Grid Layout */
        .bento-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            auto-rows: minmax(180px, auto);
        }

        /* Card Styles */
        .card {
            background-color: var(--card-bg);
            border: 1px solid #2d3139;
            border-radius: 1rem;
            padding: 1.5rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .card:hover {
            transform: translateY(-4px);
            border-color: var(--accent);
            box-shadow: 0 10px 30px -10px rgba(99, 102, 241, 0.2);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
            background: linear-gradient(90deg, var(--accent), #a855f7);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .card:hover::before { opacity: 1; }

        .type-badge {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            padding: 0.25rem 0.6rem;
            border-radius: 999px;
            background: #2d3139;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border: 1px solid transparent;
        }

        /* Category Colors */
        .badge-game { background: rgba(239, 68, 68, 0.1); color: #f87171; border-color: rgba(239, 68, 68, 0.2); }
        .badge-tool { background: rgba(59, 130, 246, 0.1); color: #60a5fa; border-color: rgba(59, 130, 246, 0.2); }
        .badge-guide { background: rgba(234, 179, 8, 0.1); color: #facc15; border-color: rgba(234, 179, 8, 0.2); }
        .badge-other { background: rgba(148, 163, 184, 0.1); color: #94a3b8; border-color: rgba(148, 163, 184, 0.2); }

        /* Search Bar */
        .search-input {
            background: #181b21;
            border: 1px solid #2d3139;
            color: white;
            transition: border-color 0.2s;
        }
        .search-input:focus {
            border-color: var(--accent);
            outline: none;
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
        }

        /* Logo Animation */
        .fade-in { animation: fadeIn 1s ease-out forwards; opacity: 0; }
        @keyframes fadeIn { to { opacity: 1; } }
    </style>
</head>
<body class="min-h-screen flex flex-col p-6 md:p-12">

    <!-- Header Section -->
    <header class="max-w-7xl mx-auto w-full mb-12 flex flex-col md:flex-row justify-between items-center gap-8">
        
        <!-- Animated Logo -->
        <div class="w-64 text-indigo-400">
            <a href="https://blueshub.netlify.app/" title="Go to Main Hub">
                <img src="logoani.svg" alt="app by blues" class="w-full h-auto">
            </a>
        </div>

        <!-- Controls -->
        <div class="flex flex-col md:flex-row gap-4 w-full md:w-auto">
            <!-- Filter Pills -->
            <div class="flex bg-[#181b21] p-1 rounded-lg border border-[#2d3139]" id="filter-container">
                <button class="px-4 py-1.5 rounded-md text-sm font-medium bg-indigo-600 text-white shadow-sm transition-all" data-filter="all">All</button>
                <button class="px-4 py-1.5 rounded-md text-sm font-medium text-gray-400 hover:text-white transition-all" data-filter="Game">Games</button>
                <button class="px-4 py-1.5 rounded-md text-sm font-medium text-gray-400 hover:text-white transition-all" data-filter="Tool">Tools</button>
                <button class="px-4 py-1.5 rounded-md text-sm font-medium text-gray-400 hover:text-white transition-all" data-filter="Guide">Guides</button>
                <button class="px-4 py-1.5 rounded-md text-sm font-medium text-gray-400 hover:text-white transition-all" data-filter="Other">Other</button>
            </div>

            <!-- Search -->
            <div class="relative">
                <i data-lucide="search" class="absolute left-3 top-2.5 h-4 w-4 text-gray-500"></i>
                <input type="text" id="search-box" placeholder="Search projects..." class="search-input pl-10 pr-4 py-1.5 rounded-lg w-full md:w-64 text-sm">
            </div>
        </div>
    </header>

    <!-- Main Grid -->
    <main class="max-w-7xl mx-auto w-full flex-grow">
        <div id="projects-grid" class="bento-grid">
            <!-- Loading Skeleton -->
            <div class="col-span-full text-center py-20 text-gray-600 animate-pulse">
                Initializing Lab Protocol...
            </div>
        </div>
    </main>

    <footer class="mt-16 text-center text-xs text-gray-600 font-mono">
        <p>SYSTEM.VERSION: 2.2.0 // SYNCED_VIA_PUBLISH_PY</p>
    </footer>

    <script>
        let allProjects = [];

        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const response = await fetch('projects.json');
                allProjects = await response.json();
                renderProjects(allProjects);
                lucide.createIcons();
            } catch (error) {
                console.error("Failed to load projects:", error);
                document.getElementById('projects-grid').innerHTML = '<p class="text-red-500">System Failure: projects.json not found.</p>';
            }

            setupFilters();
            setupSearch();
        });

        function renderProjects(projects) {
            const grid = document.getElementById('projects-grid');
            grid.innerHTML = '';

            if (projects.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center text-gray-500 py-10">No matching subjects found.</div>';
                return;
            }

            projects.forEach((p, index) => {
                const delay = index * 50; // Stagger animation
                const type = p.type || 'Other';
                const icon = getIcon(type);
                const colorClass = getColorClass(type);
                
                const card = `
                    <a href="${p.filename}" class="card group fade-in" style="animation-delay: ${delay}ms">
                        <div>
                            <div class="flex justify-between items-start mb-4">
                                <div class="p-2 bg-[#252932] rounded-lg text-indigo-400 group-hover:text-white transition-colors">
                                    <i data-lucide="${icon}" width="20"></i>
                                </div>
                                <span class="type-badge ${colorClass}">${type}</span>
                            </div>
                            <h2 class="text-lg font-bold mb-2 group-hover:text-indigo-400 transition-colors">${p.title}</h2>
                            <p class="text-sm text-gray-400 leading-relaxed line-clamp-3">${p.description}</p>
                        </div>
                        <div class="mt-4 flex items-center text-xs text-gray-500 font-mono">
                            <span>OPEN_PROJECT</span>
                            <i data-lucide="arrow-right" width="14" class="ml-2 transform group-hover:translate-x-1 transition-transform"></i>
                        </div>
                    </a>
                `;
                grid.insertAdjacentHTML('beforeend', card);
            });
            lucide.createIcons();
        }

        function getColorClass(type) {
            const map = {
                'Game': 'badge-game',
                'Tool': 'badge-tool',
                'Guide': 'badge-guide'
            };
            return map[type] || 'badge-other';
        }

        function getIcon(type) {
            const map = {
                'Game': 'gamepad-2',
                'Tool': 'wrench',
                'Guide': 'book-open'
            };
            return map[type] || 'flask-conical';
        }

        function setupFilters() {
            const buttons = document.querySelectorAll('#filter-container button');
            buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Update UI
                    buttons.forEach(b => {
                        b.classList.remove('bg-indigo-600', 'text-white', 'shadow-sm');
                        b.classList.add('text-gray-400');
                    });
                    btn.classList.remove('text-gray-400');
                    btn.classList.add('bg-indigo-600', 'text-white', 'shadow-sm');

                    // Filter Logic
                    const filter = btn.dataset.filter;
                    const filtered = filter === 'all' 
                        ? allProjects 
                        : allProjects.filter(p => {
                            const pType = p.type || 'Other';
                            if (filter === 'Other') {
                                // Match anything that isn't Game, Tool, or Guide
                                return !['Game', 'Tool', 'Guide'].includes(pType);
                            }
                            return pType === filter;
                        });
                    
                    renderProjects(filtered);
                });
            });
        }

        function setupSearch() {
            const searchBox = document.getElementById('search-box');
            searchBox.addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = allProjects.filter(p => 
                    p.title.toLowerCase().includes(term) || 
                    p.description.toLowerCase().includes(term)
                );
                renderProjects(filtered);
            });
        }
    </script>
</body>
</html>